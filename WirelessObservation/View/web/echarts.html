<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>风羽图</title>
    <script src="./echarts.js"></script>
    <script src="./jquery-3.3.1.js"></script>
    <script src="echarts.js"></script>
</head>
<body>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            height: 100%;
        }

        #echarts {
            width: 100%;
            height: 100%;
        }
    </style>
    <div id="echarts"></div>
    <script type="text/javascript">
        var legends = ['0-1', '1-2', '2-4', '4-6', '6-8', '8-10', '10-12', '12-14','14-16', '16-20', '20-24', '24-28', '28-32', '32-40', '40-60', '60-+∞'];
        var iconTitle = ['1','2','4','6','8','10','12','14','16','20','24','28','32','40','60'];
        var square = 'M0,0 L0,2100 0.1,2100 0.1,0Z M0,0 2100,0 2100,0.1 0,0.1Z';
        var iconPath = {
            wind1:square + ' M1000,0 L1100,0 1100,2100 1000,2100Z',
            wind2:square + ' M825,0 L1275,0 1275,100 925,100 925,2100 825,2100Z',
            wind4:square + ' M600,0 L1500,0 1500,100 700,100 700,2100 600,2100Z',
            wind6:square + ' M600,0 L1500,0 1500,100 700,100 700,400 1050,400 1050,500 700,500 700,2100 600,2100Z',
            wind8:square + ' M600,0 L1500,0 1500,100 700,100 700,400 1500,400 1500,500 700,500 700,2100 600,2100Z',
            wind10:square + ' M600,0 L1500,0 1500,100 700,100 700,400 1500,400 1500,500 700,500 700,800 1050,800 1050,900 700,900 700,2100 600,2100Z',
            wind12:square + ' M600,0 L1500,0 1500,100 700,100 700,400 1500,400 1500,500 700,500 700,800 1500,800 1500,900 700,900 700,2100 600,2100Z',
            wind14:square + ' M600,0 L1500,0 1500,100 700,100 700,400 1500,400 1500,500 700,500 700,800 1500,800 1500,900 700,900 700,1200 1050,1200 1050,1300 700,1300 700,2100 600,2100Z',
            wind16:square + ' M600,0 L1500,0 1500,100 700,100 700,400 1500,400 1500,500 700,500 700,800 1500,800 1500,900 700,900 700,1200 1500,1200 1500,1300 700,1300 700,2100 600,2100Z',
            wind20:square + ' M600,0 L1500,0 600,500 700,346 1128,100 600,100Z M600,0 L700,100 700,2100 600，2100Z',
            wind24:square + ' M600,0 L1500,0 600,500 700,346 1128,100 600,100Z M600,0 L700,100 700,400 1500,400 1500,500 700,500 700,2100 600,2100Z',
            wind28:square + 'M600,0 L1500,0 600,500 700,346 1128,100 600,100Z M600,0 L700,100 700,400 1500,400 1500,500 700,500 700,800 1500,800 1500,900 700,900 700,2100 600,2100Z',
            wind32:square + 'M600,0 L1500,0 600,500 700,346 1128,100 600,100Z M600,0 L700,100 700,400 1500,400 1500,500 700,500 700,800 1500,800 1500,900 700,900 700,1200 1500,1200 1500,1300 700,1300 700,2100 600,2100Z',
            wind40:square + 'M600,0 L1500,0 600,500 700,346 1128,100 600,100Z M600,400 L1500,400 600,900 700,746 1128,500 600,500Z M600,0 L700,100 700,2100 600,2100Z',
            wind60:square + 'M600,0 L1500,0 600,500 700,346 1128,100 600,100Z M600,400 L1500,400 600,900 700,746 1128,500 600,500Z M600,800 L1500,800 600,1300 700,1146 1128,900 600,900Z M600,0 L700,100 700,2100 600,2100Z'
        };
        var iconColor = {
            wind1:'#1c2ae4',
            wind2:'#1c42e4',
            wind4:'#1c6ae4',
            wind6:'#1c92e4',
            wind8:'#1cbee4',
            wind10:'#1ce6e4',
            wind12:'#1ce6bc',
            wind14:'#1ce694',
            wind16:'#1ce66c',
            wind20:'#1ce61c',
            wind24:'#64e61c',
            wind28:'#bce61c',
            wind32:'#e4ba1c',
            wind40:'#e41a1c',
            wind60:'#e41a1c'
        };


        var md = new Date();
        // 基于准备好的dom，初始化echarts实例

        var myChart = echarts.init(document.getElementById('echarts'));

        function SetChart()
        {
            var Xseries = boud.GetXSeries();
            alert(Xseries.length);
            boud.GetData().then(function(res)
            {
                var le = [];
                var series = [];
                var color = [];
                i = 0;
                var str = "";
                $.each(res,function (index, item) {
                    if (item.length > 0)
                    {
                        var data = [];

                        $.each(item, function (i,v) {
                            if(typeof(v[0]) != undefined && typeof(v[1]) != undefined)
                            {
                                var d = {};

                                d.value = [v[0] * 1, v[1] * 1];

                                d.symbolRotate = (-v[2]);
                                d.symbolSize = 30;
                                // var label = {
                                //     emphasis: {
                                //         show: true,
                                //         formatter:
                                //
                                //         ,
                                //         position: 'top'
                                //     }
                                // };

                                // d.label
                                data[i] = d;
                            }

                            // str+=v[0]+",";
                        });
                        // str += "\n"
                        var dataLegend = {};
                        dataLegend.name = legends[index];
                        var mark = legends[index].split('-');
                        var path = '';
                        eval('color[i] = iconColor.wind'+mark[0]+';');
                        eval('path=iconPath.wind'+mark[0]+';');
                        le[i] = dataLegend;
                        var serie = {
                            name: legends[index],
                            data: data,
                            type: 'scatter',
                            symbol: 'path://' + path
                        };
                        series[index] = serie;
                        i++;
                    }


                });

                op = {
                    backgroundColor: '#000000',
                    title: {
                        text: md.getFullYear() + '年' + (md.getMonth() + 1) + '月' + md.getDate() + '日风羽图'
                    },
                    color: color,
                    legend: {
                        right: 10,
                        bottom: 10,
                        orient: 'vertical',
                        data: le,
                        itemGap: 5,
                        itemHeight:30,
                        itemWidth:30,
                    },
                    xAxis: {
                        type: 'category',
                        name: '时间',
                        boundaryGap: false,
                        data: [
                            "00:00", "00:10", "00:20", "00:30", "00:40", "00:50",
                            "01:00", "01:10", "01:20", "01:30", "01:40", "01:50",
                            "02:00", "02:10", "02:20", "02:30", "02:40", "02:50",
                            "03:00", "03:10", "03:20", "03:30", "03:40", "03:50",
                            "04:00", "04:10", "04:20", "04:30", "04:40", "04:50",
                            "05:00", "05:10", "05:20", "05:30", "05:40", "05:50",
                            "06:00", "06:10", "06:20", "06:30", "06:40", "06:50",
                            "07:00", "07:10", "07:20", "07:30", "07:40", "07:50",
                            "08:00", "08:10", "08:20", "08:30", "08:40", "08:50",
                            "09:00", "09:10", "09:20", "09:30", "09:40", "09:50",
                            "10:00", "10:10", "10:20", "10:30", "10:40", "10:50",
                            "11:00", "11:10", "11:20", "11:30", "11:40", "11:50",
                            "12:00", "12:10", "12:20", "12:30", "12:40", "12:50",
                            "13:00", "13:10", "13:20", "13:30", "13:40", "13:50",
                            "14:00", "14:10", "14:20", "14:30", "14:40", "14:50",
                            "15:00", "15:10", "15:20", "15:30", "15:40", "15:50",
                            "16:00", "16:10", "16:20", "16:30", "16:40", "16:50",
                            "17:00", "17:10", "17:20", "17:30", "17:40", "17:50",
                            "18:00", "18:10", "18:20", "18:30", "18:40", "18:50",
                            "19:00", "19:10", "19:20", "19:30", "19:40", "19:50",
                            "20:00", "20:10", "20:20", "20:30", "20:40", "20:50",
                            "21:00", "21:10", "21:20", "21:30", "21:40", "21:50",
                            "22:00", "22:10", "22:20", "22:30", "22:40", "22:50",
                            "23:00", "23:10", "23:20", "23:30", "23:40", "23:50",
                        ],
                        axisLabel:{
                            interval: 2,
                            rotate: 30
                        }
                        // splitLine: {
                        //     show: true,
                        //     interval: 0,
                        //     lineStyle: {
                        //         type: 'dashed'
                        //     }
                        // }
                    },
                    yAxis: {
                        interval: 10,
                        name: '海拔高度 单位：m',
                        // boundaryGap: [100,100],
                        splitLine: {
                            show: false,
                            // lineStyle: {
                            //
                            // }
                        },
                        // scale: true
                    },

                };
                op.series = series;
                myChart.clear();
                myChart.setOption(op);
            });
        }

        $(function() {
            SetChart();


        });

    </script>
</body>
</html>